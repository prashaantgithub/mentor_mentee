<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Mentee Report</title>
    <style>
        @page {
            size: A4 landscape;
            margin: 1.5cm;
        }
        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
        }
        .page-break {
            page-break-before: always;
        }
        h1, h2, h3 {
            text-align: center;
            margin: 0;
            padding: 0;
        }
        h1 { font-size: 16pt; margin-bottom: 5px; }
        h2 { font-size: 14pt; margin-bottom: 20px; }
        h3 { font-size: 12pt; text-align: left; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #000; padding-bottom: 5px;}
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #000;
            padding: 6px;
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .profile-container { display: flex; align-items: center; gap: 30px; }
        .profile-picture { width: 120px; height: 120px; object-fit: cover; border: 1px solid #000; }
        .profile-details { flex-grow: 1; }
        .detail-item { margin-bottom: 8px; }
        .detail-item strong { display: inline-block; width: 150px; }
    </style>
</head>
<body>
    <h1>Department of Computer Science and Engineering</h1>
    <h2>Mentoring Report</h2>

    <!-- Page 1: Profile -->
    <div class="profile-container">
        <img src="{{ profile_pic_path }}" class="profile-picture">
        <div class="profile-details">
            <div class="detail-item"><strong>Name:</strong> {{ mentee.name }}</div>
            <div class="detail-item"><strong>Registration No:</strong> {{ mentee.mentee_profile.reg_num }}</div>
            <div class="detail-item"><strong>Email:</strong> {{ mentee.email }}</div>
            <div class="detail-item"><strong>Class:</strong> {{ mentee.mentee_profile.assigned_class.name }}</div>
            <div class="detail-item"><strong>Batch:</strong> {{ mentee.mentee_profile.batch.name }}</div>
            <div class="detail-item"><strong>Date of Birth:</strong> {{ mentee.mentee_profile.dob.strftime('%d-%m-%Y') if mentee.mentee_profile.dob else 'N/A' }}</div>
        </div>
    </div>

    <!-- Page 2: Academic Mark Details -->
    <div class="page-break">
        <h3>Academic Mark Details</h3>
        <table>
            <thead>
                <tr>
                    <th>Semester</th>
                    <th>Subject</th>
                    <th>Grade</th>
                    <th>GPA</th>
                    <th>CGPA</th>
                    <th>Attendance %</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.academic %}
                    <tr>
                        <td>{{ record.semester }}</td>
                        <td>{{ record.subject_code_name }}</td>
                        <td>{{ record.grade }}</td>
                        <td>{{ record.gpa }}</td>
                        <td>{{ record.cgpa }}</td>
                        <td>{{ record.attendance_percentage }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="6">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 3: Honors / Minors Marks Details -->
    <div class="page-break">
        <h3>Honors / Minors Marks Details</h3>
        <table>
             <thead>
                <tr>
                    <th>Type</th>
                    <th>Semester</th>
                    <th>Subject</th>
                    <th>Grade</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.honors_minors %}
                    <tr>
                        <td>{{ record.course_type }}</td>
                        <td>{{ record.semester }}</td>
                        <td>{{ record.subject_code_name }}</td>
                        <td>{{ record.grade }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 4: Internship Information -->
    <div class="page-break">
        <h3>Internship Information</h3>
        <table>
            <thead>
                <tr>
                    <th>Company Name</th>
                    <th>Duration</th>
                    <th>Domain</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.internships %}
                    <tr>
                        <td>{{ record.company_name }}</td>
                        <td>{{ record.duration_from.strftime('%d-%b-%Y') }} to {{ record.duration_to.strftime('%d-%b-%Y') }}</td>
                        <td>{{ record.technology_domain }}</td>
                        <td>{{ record.internship_status }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 5: Placement Information -->
    <div class="page-break">
        <h3>Placement Information</h3>
        <table>
            <thead>
                <tr>
                    <th>Company Name</th>
                    <th>CTC (Rs.)</th>
                    <th>Interview Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.placements %}
                    <tr>
                        <td>{{ record.company_name }}</td>
                        <td>{{ record.annual_ctc }}</td>
                        <td>{{ record.interview_date.strftime('%d-%b-%Y') }}</td>
                        <td>{{ record.interview_status }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 6: Research Record -->
    <div class="page-break">
        <h3>Research Record</h3>
         <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Publication Name</th>
                    <th>Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.research %}
                    <tr>
                        <td>{{ record.title }}</td>
                        <td>{{ record.publication_name }}</td>
                        <td>{{ record.publication_date.strftime('%d-%b-%Y') }}</td>
                        <td>{{ record.publication_status }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 7: Co-Curricular Activity Record -->
    <div class="page-break">
        <h3>Co-Curricular Activity Record</h3>
        <table>
            <thead>
                <tr>
                    <th>Activity Name</th>
                    <th>Activity Type</th>
                    <th>Conducted By</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.cocurricular %}
                    <tr>
                        <td>{{ record.activity_name }}</td>
                        <td>{{ record.activity_type }}</td>
                        <td>{{ record.conducted_by }}</td>
                        <td>{{ record.date.strftime('%d-%b-%Y') }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Page 8: Extra-Curricular Activity Record -->
    <div class="page-break">
        <h3>Extra-Curricular Activity Record</h3>
        <table>
            <thead>
                <tr>
                    <th>Activity Name</th>
                    <th>Activity Type</th>
                    <th>Conducted By</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.extracurricular %}
                    <tr>
                        <td>{{ record.activity_name }}</td>
                        <td>{{ record.activity_type }}</td>
                        <td>{{ record.conducted_by }}</td>
                        <td>{{ record.date.strftime('%d-%b-%Y') }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 9: Awards and Achievements -->
    <div class="page-break">
        <h3>Awards and Achievements</h3>
        <table>
             <thead>
                <tr>
                    <th>Award Name</th>
                    <th>Award Type</th>
                    <th>Conducted By</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records.awards %}
                    <tr>
                        <td>{{ record.award_achievement_name }}</td>
                        <td>{{ record.award_achievement_type }}</td>
                        <td>{{ record.conducted_by }}</td>
                        <td>{{ record.date.strftime('%d-%b-%Y') }}</td>
                    </tr>
                {% else %}
                    <tr><td colspan="4">No records found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Page 10+: Mentor Meeting Details -->
    {% for record in records.meetings %}
    <div class="page-break">
        <h3>Mentor Meeting Details (Session #{{ record.session.session_number }})</h3>
        <p><strong>Date:</strong> {{ record.session.start_time|timestamp_to_local('full') }}</p>
        <h4>Points Discussed:</h4>
        <p>{{ record.points_discussed }}</p>
        <h4>Remarks Given:</h4>
        <p>{{ record.remarks_given }}</p>
    </div>
    {% endfor %}

</body>
</html>